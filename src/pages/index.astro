---
/**
 * Home Page - Blog post listing with search
 */

import Layout from "../layouts/Layout.astro";
import "../styles/home.css";
import Logo from "../components/Logo.astro";
import PostCard from "../components/PostCard.astro";
import { getPublishedPosts } from "../utils/posts";

const sortedPosts = await getPublishedPosts();
---

<Layout title="Home | fpl0">
  <header class="home-header">
    <div class="home-bar">
      <Logo text="fpl0" />
      <nav class="home-nav">
        <a href="/about">about</a>
        <span class="separator">/</span>
        <a href="/tags/">tags</a>
        <span class="separator">/</span>
        <button
          class="search-hint"
          id="search-hint"
          type="button"
          aria-label="Search"
          aria-controls="search-backdrop"
        >
          <span class="search-hint-text">search</span>
          <kbd>âŒ˜K</kbd>
        </button>
      </nav>
    </div>
    <blockquote class="bio-quote">
      <p>"True delight is in the finding out rather than in the knowing."</p>
      <cite>Isaac Asimov</cite>
    </blockquote>
  </header>
  <main id="main-content" class="home-main">
    {sortedPosts.length > 0 ? (
      <section class="archive">
        <ul class="post-list">
          {sortedPosts.map((post) => <PostCard post={post} />)}
        </ul>
      </section>
    ) : (
      <section class="empty-state">
        <p class="empty-greeting">Hello, World!</p>
      </section>
    )}
  </main>
</Layout>

<script>
  import { openSearch } from "../utils/search-trigger";

  function initSearchHint(): void {
    const hint = document.getElementById("search-hint");
    hint?.addEventListener("click", () => openSearch());
  }

  document.addEventListener("astro:page-load", initSearchHint);
</script>
